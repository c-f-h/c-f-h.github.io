<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Connect-Zero: Reinforcement Learning from Scratch | cfh::blog</title>
<meta name="keywords" content="ML, RL">
<meta name="description" content="For a long time I&rsquo;ve wanted to get deeper into reinforcement learning (RL), and the project
I finally settled on is teaching a neural network model
how to play the classic game Connect 4 (pretty sneaky, sis!).
Obviously, the name &ldquo;Connect-Zero&rdquo; is a cheeky nod to AlphaGo Zero
and AlphaZero by DeepMind.
I chose Connect 4 because it&rsquo;s a simple game everyone knows how to play where we can
hope to achieve good results without expensive hardware and high training costs.">
<meta name="author" content="cfh">
<link rel="canonical" href="https://c-f-h.github.io/post/connect-zero/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.024295b3c968fbd469a11050839fd375a96747c3a5cff215e7f577090fe610f8.css" integrity="sha256-AkKVs8lo&#43;9RpoRBQg5/TdalnR8Olz/IV5/V3CQ/mEPg=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://c-f-h.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://c-f-h.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://c-f-h.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://c-f-h.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://c-f-h.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://c-f-h.github.io/post/connect-zero/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><head>
  
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    },
    loader:{
      load: ['ui/safe']
    },
  };
</script>
  
  
  
</head><meta property="og:url" content="https://c-f-h.github.io/post/connect-zero/">
  <meta property="og:site_name" content="cfh::blog">
  <meta property="og:title" content="Connect-Zero: Reinforcement Learning from Scratch">
  <meta property="og:description" content="For a long time I’ve wanted to get deeper into reinforcement learning (RL), and the project I finally settled on is teaching a neural network model how to play the classic game Connect 4 (pretty sneaky, sis!). Obviously, the name “Connect-Zero” is a cheeky nod to AlphaGo Zero and AlphaZero by DeepMind. I chose Connect 4 because it’s a simple game everyone knows how to play where we can hope to achieve good results without expensive hardware and high training costs.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-04-20T13:12:41+02:00">
    <meta property="article:modified_time" content="2025-04-20T13:12:41+02:00">
    <meta property="article:tag" content="ML">
    <meta property="article:tag" content="RL">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Connect-Zero: Reinforcement Learning from Scratch">
<meta name="twitter:description" content="For a long time I&rsquo;ve wanted to get deeper into reinforcement learning (RL), and the project
I finally settled on is teaching a neural network model
how to play the classic game Connect 4 (pretty sneaky, sis!).
Obviously, the name &ldquo;Connect-Zero&rdquo; is a cheeky nod to AlphaGo Zero
and AlphaZero by DeepMind.
I chose Connect 4 because it&rsquo;s a simple game everyone knows how to play where we can
hope to achieve good results without expensive hardware and high training costs.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://c-f-h.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Connect-Zero: Reinforcement Learning from Scratch",
      "item": "https://c-f-h.github.io/post/connect-zero/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Connect-Zero: Reinforcement Learning from Scratch",
  "name": "Connect-Zero: Reinforcement Learning from Scratch",
  "description": "For a long time I\u0026rsquo;ve wanted to get deeper into reinforcement learning (RL), and the project I finally settled on is teaching a neural network model how to play the classic game Connect 4 (pretty sneaky, sis!). Obviously, the name \u0026ldquo;Connect-Zero\u0026rdquo; is a cheeky nod to AlphaGo Zero and AlphaZero by DeepMind. I chose Connect 4 because it\u0026rsquo;s a simple game everyone knows how to play where we can hope to achieve good results without expensive hardware and high training costs.\n",
  "keywords": [
    "ML", "RL"
  ],
  "articleBody": "For a long time I’ve wanted to get deeper into reinforcement learning (RL), and the project I finally settled on is teaching a neural network model how to play the classic game Connect 4 (pretty sneaky, sis!). Obviously, the name “Connect-Zero” is a cheeky nod to AlphaGo Zero and AlphaZero by DeepMind. I chose Connect 4 because it’s a simple game everyone knows how to play where we can hope to achieve good results without expensive hardware and high training costs.\nSome ground rules:\nThe neural network model gets nothing but the current board state as a 6x7 grid and outputs a classifier over the seven columns for which move to play next. Like AlphaZero, it doesn’t train on any human games, but only on computer-generated ones. Unlike AlphaZero, it doesn’t do any tree seach to find the best moves, for multiple reasons: for simplicity, and because I was curious to see how far you could get with a simple move predictor. In fact, there’s precedent to show that even for Chess, a vastly more complicated game, this can work well: see the DeepMind paper Grandmaster-Level Chess Without Search, which trained a pure next-move predictor for Chess. However, they used Stockfish as a teacher for their model, rather than self-play. I also strongly suspect that Connect 4 is shallow enough that tree search might trivialize it, and that wouldn’t leave much room for any interesting RL. Build it from scratch in PyTorch, without relying on any existing RL framework. The point is to learn about the techniques more than just getting to the end. You can actually play against a version of the current model right now! It will take a couple of blog posts until we catch up to that level, though.\n",
  "wordCount" : "293",
  "inLanguage": "en",
  "datePublished": "2025-04-20T13:12:41+02:00",
  "dateModified": "2025-04-20T13:12:41+02:00",
  "author":{
    "@type": "Person",
    "name": "cfh"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://c-f-h.github.io/post/connect-zero/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "cfh::blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://c-f-h.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://c-f-h.github.io/" accesskey="h" title="cfh::blog (Alt + H)">cfh::blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://c-f-h.github.io/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://c-f-h.github.io/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://c-f-h.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://c-f-h.github.io/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Connect-Zero: Reinforcement Learning from Scratch
    </h1>
    <div class="post-meta"><span title='2025-04-20 13:12:41 +0200 CEST'>April 20, 2025</span>&nbsp;·&nbsp;cfh

</div>
  </header> 
  <div class="post-content"><p>For a long time I&rsquo;ve wanted to get deeper into reinforcement learning (RL), and the project
I finally settled on is teaching a neural network model
how to play the classic game <strong>Connect 4</strong> (<a href="https://www.youtube.com/watch?v=KN3nohBw_CE">pretty sneaky, sis!</a>).
Obviously, the name &ldquo;Connect-Zero&rdquo; is a cheeky nod to AlphaGo Zero
and AlphaZero by DeepMind.
I chose Connect 4 because it&rsquo;s a simple game everyone knows how to play where we can
hope to achieve good results without expensive hardware and high training costs.</p>
<figure class="align-center ">
    <img loading="lazy" src="screenshot.png#center"
         alt="A screenshot of a Connect 4 game" width="200"/> 
</figure>

<p>Some ground rules:</p>
<ul>
<li>The neural network model gets nothing but the current board state as a 6x7 grid and
outputs a classifier over the seven columns for which move to play next.</li>
<li>Like AlphaZero, it doesn&rsquo;t train on any human games, but only on computer-generated ones.</li>
<li>Unlike AlphaZero, it doesn&rsquo;t do any tree seach to find the best moves, for multiple
reasons:
for simplicity, and because I was curious to see how far you could get with a
simple move predictor. In fact, there&rsquo;s precedent to show that even for Chess, a vastly
more complicated game, this can work well: see the DeepMind paper
<a href="https://arxiv.org/pdf/2402.04494v1">Grandmaster-Level Chess Without Search</a>, which
trained a pure next-move predictor for Chess. However, they used Stockfish as a teacher
for their model, rather than self-play.
I also strongly suspect that Connect 4 is shallow enough that tree search might
trivialize it, and that wouldn&rsquo;t leave much room for any interesting RL.</li>
<li>Build it from scratch in PyTorch, without relying on any existing RL framework. The
point is to learn about the techniques more than just getting to the end.</li>
</ul>
<p>You can actually <a href="/post/connect-4/">play against a version</a> of the current model
right now! It will take a couple of blog posts until we catch up to that level, though.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://c-f-h.github.io/tags/ml/">ML</a></li>
      <li><a href="https://c-f-h.github.io/tags/rl/">RL</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://c-f-h.github.io/post/connect-4/">
    <span class="title">« Prev</span>
    <br>
    <span>Connect 4</span>
  </a>
  <a class="next" href="https://c-f-h.github.io/post/basic-setup-and-play/">
    <span class="title">Next »</span>
    <br>
    <span>Basic Setup and Play</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://c-f-h.github.io/">cfh::blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
